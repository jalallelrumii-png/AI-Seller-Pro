<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ScriptLaku PRO - AI Live Selling</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/9752/9752284.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .glass { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); }
        .ios-card { border-radius: 28px; transition: transform 0.2s ease; }
        .ios-card:active { transform: scale(0.98); }
        
        /* Dark Mode Colors */
        .dark-theme { background: #000000; color: #ffffff; }
        .dark-theme .card-bg { background: rgba(28, 28, 30, 0.8); border: 1px solid rgba(255,255,255,0.1); }
        .dark-theme .input-bg { background: rgba(44, 44, 46, 1); color: white; }
        
        /* Light Mode Colors */
        .light-theme { background: #F2F2F7; color: #000000; }
        .light-theme .card-bg { background: rgba(255, 255, 255, 0.8); border: 1px solid rgba(0,0,0,0.05); }
        .light-theme .input-bg { background: rgba(229, 229, 234, 1); color: black; }

        .btn-gradient { background: linear-gradient(135deg, #FF375F 0%, #BF5AF2 100%); }
        [x-cloak] { display: none !important; }
    </style>
</head>
<body x-data="app()" :class="darkMode ? 'dark-theme' : 'light-theme'" x-cloak>

    <nav class="sticky top-0 z-50 glass border-b border-black/5 dark:border-white/5 py-4 px-6 flex justify-between items-center" :class="darkMode ? 'bg-black/60' : 'bg-white/60'">
        <div>
            <h1 class="text-2xl font-extrabold tracking-tight italic">Script<span class="text-pink-500">Laku</span></h1>
            <p class="text-[10px] font-bold uppercase tracking-widest opacity-50">AI Live Stream Generator</p>
        </div>
        <div class="flex gap-3">
            <button @click="darkMode = !darkMode" class="p-3 rounded-2xl card-bg text-xl shadow-sm">
                <span x-text="darkMode ? 'â˜€ï¸' : 'ğŸŒ™'"></span>
            </button>
            <button @click="openSettings = true" class="p-3 rounded-2xl card-bg text-xl shadow-sm">âš™ï¸</button>
        </div>
    </nav>

    <main class="p-5 max-w-2xl mx-auto pb-32">
        <div class="flex justify-between mb-6 overflow-x-auto pb-2 gap-2 no-scrollbar">
            <template x-for="(prod, index) in products" :key="index">
                <button @click="activeTab = index" 
                    :class="activeTab === index ? 'btn-gradient text-white scale-105 shadow-lg' : 'card-bg opacity-60'"
                    class="px-5 py-3 rounded-2xl font-bold text-sm transition-all whitespace-nowrap min-w-[80px]">
                    Item <span x-text="index + 1"></span>
                </button>
            </template>
        </div>

        <div class="ios-card card-bg p-6 shadow-xl space-y-5">
            <div>
                <label class="text-[11px] font-black uppercase tracking-widest opacity-40 mb-2 block">Script Type</label>
                <select x-model="products[activeTab].type" class="w-full input-bg p-4 rounded-2xl font-semibold outline-none appearance-none">
                    <option>ğŸ¯ Opening Live</option>
                    <option>ğŸ›ï¸ Presentasi Produk</option>
                    <option>âš¡ Flash Sale</option>
                    <option>ğŸ Closing</option>
                    <option>ğŸ’¬ Boost Engagement</option>
                </select>
            </div>

            <div>
                <label class="text-[11px] font-black uppercase tracking-widest opacity-40 mb-2 block">Kategori</label>
                <select x-model="products[activeTab].cat" class="w-full input-bg p-4 rounded-2xl font-semibold outline-none appearance-none">
                    <option>ğŸ‘— Fashion</option>
                    <option>ğŸ“± Elektronik</option>
                    <option>ğŸ’„ Kecantikan</option>
                    <option>ğŸ  Rumah Tangga</option>
                    <option>ğŸ“¦ Lainnya</option>
                </select>
            </div>

            <div class="space-y-4">
                <input type="text" x-model="products[activeTab].name" placeholder="Nama Produk (Misal: Jaket Denim Pria)" class="w-full input-bg p-4 rounded-2xl font-medium outline-none">
                
                <div class="grid grid-cols-2 gap-3">
                    <input type="text" x-model="products[activeTab].priceNormal" placeholder="Harga Normal" class="w-full input-bg p-4 rounded-2xl text-center outline-none">
                    <input type="text" x-model="products[activeTab].priceLive" placeholder="Harga Live" class="w-full input-bg p-4 rounded-2xl text-center font-bold text-pink-500 outline-none border border-pink-500/30">
                </div>

                <textarea x-model="products[activeTab].benefit" placeholder="Keunggulan (Bahan adem, anti air, dll)..." class="w-full input-bg p-4 rounded-2xl h-28 resize-none outline-none"></textarea>
            </div>

            <div>
                <label class="text-[11px] font-black uppercase tracking-widest opacity-40 mb-2 block">Gaya Bahasa</label>
                <select x-model="products[activeTab].style" class="w-full input-bg p-4 rounded-2xl font-semibold outline-none appearance-none">
                    <option>ğŸ”¥ Energik</option>
                    <option>ğŸ˜Š Friendly</option>
                    <option>ğŸ‘” Professional</option>
                    <option>ğŸ˜† Lucu</option>
                </select>
            </div>

            <button @click="generateAll()" :disabled="loading" class="w-full btn-gradient py-5 rounded-[24px] text-white font-extrabold text-lg shadow-2xl shadow-pink-500/30 active:scale-95 transition-all">
                <span x-show="!loading">ğŸš€ Generate Script</span>
                <span x-show="loading" class="flex justify-center items-center gap-2">
                    <svg class="animate-spin h-5 w-5 text-white" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                    Processing...
                </span>
            </button>
        </div>

        <div x-show="products[activeTab].result" class="mt-8 ios-card card-bg p-6 space-y-4" x-transition>
            <div class="flex justify-between items-center">
                <h3 class="font-bold text-xl">Script Result</h3>
                <button @click="copy(products[activeTab].result)" class="px-4 py-2 bg-blue-500 text-white text-xs font-bold rounded-xl shadow-lg shadow-blue-500/20">COPY</button>
            </div>
            <div class="text-[15px] leading-relaxed opacity-90 whitespace-pre-wrap" x-html="products[activeTab].result"></div>
        </div>
    </main>

    <div x-show="openSettings" class="fixed inset-0 z-[100] glass flex items-center justify-center p-6 bg-black/40">
        <div class="card-bg w-full max-w-sm p-8 ios-card text-center" @click.away="openSettings = false">
            <h3 class="text-xl font-bold mb-6">Configuration</h3>
            <input type="password" x-model="apiKey" placeholder="Masukkan API Key Anda" class="w-full input-bg p-4 rounded-2xl mb-6 text-center">
            <button @click="saveSettings()" class="w-full btn-gradient p-4 rounded-2xl text-white font-bold">Simpan & Tutup</button>
        </div>
    </div>

    <script>
        function app() {
            return {
                darkMode: true,
                activeTab: 0,
                loading: false,
                openSettings: false,
                apiKey: localStorage.getItem('scriptlaku_key') || '',
                products: Array.from({length: 5}, () => ({
                    type: 'ğŸ¯ Opening Live',
                    cat: 'ğŸ‘— Fashion',
                    name: '',
                    priceNormal: '',
                    priceLive: '',
                    benefit: '',
                    style: 'ğŸ”¥ Energik',
                    result: ''
                })),

                saveSettings() {
                    localStorage.setItem('scriptlaku_key', this.apiKey);
                    this.openSettings = false;
                },

                async generateAll() {
                    if(!this.apiKey) return this.openSettings = true;
                    const p = this.products[this.activeTab];
                    if(!p.name) return alert('Nama produk kosong, bos!');

                    this.loading = true;
                    try {
                        const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                            method: 'POST',
                            headers: { 'Authorization': `Bearer ${this.apiKey}`, 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                model: "llama-3.3-70b-versatile",
                                messages: [{
                                    role: "user",
                                    content: `Buatkan skrip penjualan live streaming. Tipe: ${p.type}, Produk: ${p.name}, Kategori: ${p.cat}, Harga Normal: ${p.priceNormal}, Harga Live: ${p.priceLive}, Benefit: ${p.benefit}, Gaya Bahasa: ${p.style}. Buat yang sangat persuasif!`
                                }]
                            })
                        });
                        const data = await response.json();
                        p.result = data.choices[0].message.content.replace(/\n/g, '<br>');
                    } catch (e) {
                        alert('API Error! Cek koneksi atau Key lo.');
                    } finally {
                        this.loading = false;
                    }
                },

                copy(txt) {
                    const cleanTxt = txt.replace(/<br>/g, '\n');
                    navigator.clipboard.writeText(cleanTxt);
                    alert('Script disalin ke clipboard!');
                }
            }
        }

        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>
</html>
